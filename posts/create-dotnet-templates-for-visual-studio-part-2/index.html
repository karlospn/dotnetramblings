<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>How to build a .NET template and use it within Visual Studio. Part 2: Creating a template package :: my tech ramblings — A blog for writing about my techie ramblings</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="This is a 2 part-series.
 Part 1: Key concepts that you should know when creating a .NET template. If you want to read it, click here Part 2: How to convert a few .NET apps into .NET templates, package them together in a single NuGet pack and use them as templates within Visual Studio.   Just show me the code
As always if you don’t care about the post I have upload the source code on my Github."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://www.mytechramblings.com/posts/create-dotnet-templates-for-visual-studio-part-2/" />





<link rel="stylesheet" href="https://www.mytechramblings.com/assets/style.css">


<link rel="stylesheet" href="https://www.mytechramblings.com/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://www.mytechramblings.com/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="https://www.mytechramblings.com/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="How to build a .NET template and use it within Visual Studio. Part 2: Creating a template package"/>
<meta name="twitter:description" content="This is a 2 part-series.
 Part 1: Key concepts that you should know when creating a .NET template. If you want to read it, click here Part 2: How to convert a few .NET apps into .NET templates, package them together in a single NuGet pack and use them as templates within Visual Studio.   Just show me the code
As always if you don’t care about the post I have upload the source code on my Github."/>



<meta property="og:title" content="How to build a .NET template and use it within Visual Studio. Part 2: Creating a template package" />
<meta property="og:description" content="This is a 2 part-series.
 Part 1: Key concepts that you should know when creating a .NET template. If you want to read it, click here Part 2: How to convert a few .NET apps into .NET templates, package them together in a single NuGet pack and use them as templates within Visual Studio.   Just show me the code
As always if you don’t care about the post I have upload the source code on my Github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.mytechramblings.com/posts/create-dotnet-templates-for-visual-studio-part-2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-06-17T10:01:29+02:00" />
<meta property="article:modified_time" content="2021-06-17T10:01:29+02:00" /><meta property="og:site_name" content="my tech ramblings" />







  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="https://www.mytechramblings.com/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">my tech ramblings</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  
  

  <div class="post">
    <h1 class="post-title"><a href="https://www.mytechramblings.com/posts/create-dotnet-templates-for-visual-studio-part-2/">How to build a .NET template and use it within Visual Studio. Part 2: Creating a template package</a></h1>
    <div class="post-meta">
      
        <span class="post-date">
          2021-06-17
        </span>

        
          
            



          
        
      

      
      
        <span class="post-read-time">— 27 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="https://www.mytechramblings.com/tags/dotnet/">dotnet</a>&nbsp;
        
          #<a href="https://www.mytechramblings.com/tags/csharp/">csharp</a>&nbsp;
        
          #<a href="https://www.mytechramblings.com/tags/templates/">templates</a>&nbsp;
        
          #<a href="https://www.mytechramblings.com/tags/vs/">vs</a>&nbsp;
        
          #<a href="https://www.mytechramblings.com/tags/visual/">visual</a>&nbsp;
        
          #<a href="https://www.mytechramblings.com/tags/studio/">studio</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      
      <blockquote>
<p>This is a 2 part-series.</p>
<ul>
<li><strong>Part 1</strong>: Key concepts that you should know when creating a .NET template. If you want to read it, click <a href="https://www.mytechramblings.com/posts/create-dotnet-templates-for-visual-studio-part-1/"><strong>here</strong></a></li>
<li><strong>Part 2</strong>: How to convert a few .NET apps into .NET templates, package them together in a single NuGet pack and use them as templates within Visual Studio.</li>
</ul>
</blockquote>
<p><strong>Just show me the code</strong><br>
As always if you don’t care about the post I have upload the source code on my <a href="https://github.com/karlospn/MyTechRamblings.Templates">Github</a>.<br>
Also I have upload the NuGet package to <a href="https://www.nuget.org/packages/MyTechRamblings.Templates">nuget.org</a>.</p>
<h1 id="creating-the-mytechramblingstemplates-package"><strong>Creating the MyTechRamblings.Templates package</strong></h1>
<p>In the following sections I will be converting 3 apps into .NET templates, package them in a NuGet pack named <code>MyTechRamblings.Templates</code> and showing you how to use them within Visual Studio.</p>
<p>The <code>MyTechRamblings.Templates</code> package will contain 2 solution templates and 1 project template.</p>
<p>Before start coding remember what I said in part 1:</p>
<blockquote>
<ul>
<li><strong>Using custom .NET templates within Visual Studio is only available in Visual Studio version 16.8 or higher</strong>.</li>
<li><strong>Also if you&rsquo;re creating or using a solution template you need at least Visual Studio version 16.10 or higher.</strong></li>
</ul>
</blockquote>
<h1 id="1-prerequisites">1. Prerequisites:</h1>
<p><strong>I have develop 3 apps beforehand</strong>, that&rsquo;s because in this post I will focus on the process of converting these 3 apps in templates.</p>
<p>The 3 apps I have built are the following ones:</p>
<ul>
<li>
<p><strong>NET 5 Web Api</strong></p>
<ul>
<li>It is an entire solution application.</li>
<li>It uses a N-layer architecture with 3 layers:
<ul>
<li><code>WebApi</code> layer.</li>
<li><code>Library</code> layer.</li>
<li><code>Repository</code> layer.</li>
</ul>
</li>
<li>It uses the <code>Microsoft.Build.CentralPackageVersions</code> MSBuild SDK. This SDK allows us to manage all the NuGet package versions in a single file. The file can be found in the <code>/build</code> folder.</li>
<li>The api has the following features already built-in:
<ul>
<li><code>HealthChecks</code></li>
<li><code>Swagger</code></li>
<li><code>Serilog</code></li>
<li><code>AutoMapper</code></li>
<li><code>Microsoft.Identity.Web</code></li>
<li><code>Dockerfile</code></li>
</ul>
</li>
<li>It includes an <code>Azure Pipelines</code> YAML file and a <code>GitHub Action</code> YAML file that deploys the api into an Azure App Service.</li>
</ul>
<blockquote>
<p>If you want to take a look at the api source code, click <a href="https://github.com/karlospn/MyTechRamblings.Templates/tree/main/src/WebApiNet5Template">HERE</a></p>
</blockquote>
</li>
<li>
<p><strong>NET 5 Worker Service that consumes RabbitMq messages</strong></p>
<ul>
<li>It is an entire solution application.</li>
<li>The application is a <code>BackgroundService</code> that consumes messages from a RabbitMq server. It uses a N-layer architecture with 3 layers:
<ul>
<li><code>Worker</code> layer.</li>
<li><code>Library</code> layer.</li>
<li><code>Repository</code> layer.</li>
</ul>
</li>
<li>It uses the <code>Microsoft.Build.CentralPackageVersions</code> MSBuild SDK. This SDK allows us to manage all the NuGet package versions in a single file. The file can be found in the <code>/build</code> folder.</li>
<li>The service has the following features already built-in:
<ul>
<li><code>Serilog</code></li>
<li><code>AutoMapper</code></li>
<li><code>Microsoft.Extensions.Hosting.Systemd</code></li>
<li><code>Microsoft.Extensions.Hosting.WindowsServices</code></li>
<li><code>Dockerfile</code></li>
</ul>
</li>
<li>It includes an <code>Azure Pipelines</code> YAML file and a <code>GitHub Action</code> YAML file that deploys the service into an Azure App Service.</li>
</ul>
<blockquote>
<p>If you want to take a look at the worker source code, click <a href="https://github.com/karlospn/MyTechRamblings.Templates/tree/main/src/HostedServiceNet5RabbitConsumerTemplate">HERE</a></p>
</blockquote>
</li>
<li>
<p><strong>NET Core 3.1 Azure Function that gets triggered by a timer</strong></p>
<ul>
<li>This one is not an entire solution, instead it is just a single project.</li>
<li>It is a NET Core 3.1 Azure Function that is triggered by a timer.</li>
<li>The function has the following features already built-in:
<ul>
<li><code>Dependency Injection</code></li>
<li><code>Logging</code></li>
</ul>
</li>
<li>It includes an <code>Azure Pipelines</code> YAML file and a <code>GitHub Action</code> YAML file that deploys the function into Azure Functions.</li>
</ul>
<blockquote>
<p>If you want to take a look at the function source code, click <a href="https://github.com/karlospn/MyTechRamblings.Templates/tree/main/src/AzureFunctionTimerProjectTemplate">HERE</a></p>
</blockquote>
</li>
</ul>
<h1 id="2-convert-the-net-5-web-api-into-a-template">2. Convert the NET 5 Web Api into a template</h1>
<h2 id="21-create-the-templatejson-file">2.1. <strong>Create the template.json file</strong></h2>
<p>The first step is to create the <code>template.json</code> file, but before start building it you need to know what you want to parameterize in the template.</p>
<p>After taking a look at the different features I have built on the api, I have come with a list of features that I want to parameterize.</p>
<table>
<thead>
<tr>
<th>Parameter  Name</th>
<th>Description</th>
<th>Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Docker</strong></td>
<td>Adds or removes a Dockerfile file.</td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>ReadMe</strong></td>
<td>Adds or removes a README markdown file describing the project.</td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>Tests</strong></td>
<td>Adds or removes the tests projects from the solution. Removes an Integration Test project and a Unit Test project.</td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>GitHub</strong></td>
<td>Adds or removes a GitHub Action file from the solution. This GitHub Action is used to deploy the api into an Azure Web App.</td>
<td><em>false</em></td>
</tr>
<tr>
<td><strong>AzurePipelines</strong></td>
<td>Adds or removes an Azure pipeline YAML file from the solution. The pipeline is used to deploy the api into an Azure Web App.</td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>DeploymentType</strong></td>
<td>Specifies how you want to deploy the api. The possible values are <code>DeployAsZip</code> or <code>DeployAsContainer</code>.    Depending of the value you choose the content of the deployment pipeline will vary.    If you choose to not create neither a GitHub Action nor an Azure Pipeline this parameter is useless.</td>
<td><em>DeployAsZip</em></td>
</tr>
<tr>
<td><strong>AcrName</strong></td>
<td>An Azure ACR registry name. Only used if you are going to be deploying using a container.</td>
<td><em>acrcponsndev</em></td>
</tr>
<tr>
<td><strong>AzureSubscriptionName</strong></td>
<td>An Azure DevOps Service Endpoint Name. Only used if deploying with Azure Pipelines.</td>
<td><em>cponsn-dev-subscription</em></td>
</tr>
<tr>
<td><strong>AppServiceName</strong></td>
<td>The name of the Azure App Service where the app will be deployed.</td>
<td><em>app-svc-demo-dev</em></td>
</tr>
<tr>
<td><strong>Authorization</strong></td>
<td>Enables or disables the use of authorization using <code>Microsoft.Identity.Web</code></td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>AzureAdTenantId</strong></td>
<td>Azure Active Directory Tenant Id. Only necessary if <code>Authorization</code> is enabled.</td>
<td><em>8a0671e2-3a30-4d30-9cb9-ad709b9c744a</em></td>
</tr>
<tr>
<td><strong>AzureAdDomain</strong></td>
<td>Azure Active Directory Domain Name. Only necessary if <code>Authorization</code> is enabled.</td>
<td><em>cpnoutlook.onmicrosoft.com</em></td>
</tr>
<tr>
<td><strong>AzureAdClientId</strong></td>
<td>Azure Active Directory App Client Id. Only necessary if <code>Authorization</code> is enabled.</td>
<td><em>fdada45d-8827-466f-82a5-179724a3c268</em></td>
</tr>
<tr>
<td><strong>AzureAdSecret</strong></td>
<td>Azure Active Directory App Secret Value. Only necessary if <code>Authorization</code> is enabled.</td>
<td><em>1234</em></td>
</tr>
<tr>
<td><strong>HealthCheck</strong></td>
<td>Enables or disables the use of healthchecks.</td>
<td>true</td>
</tr>
<tr>
<td><strong>HealthCheckPath</strong></td>
<td>HealthCheck api path. Only necessary if <code>HealthCheck</code> is enabled.</td>
<td><em>/health</em></td>
</tr>
<tr>
<td><strong>Swagger</strong></td>
<td>Enables or disables the use of Swagger.</td>
<td><em>true</em></td>
</tr>
<tr>
<td><strong>SwaggerPath</strong></td>
<td>Swagger api path. Only necessary if <code>Swagger</code> is enabled.</td>
<td><em>api-docs</em></td>
</tr>
<tr>
<td><strong>Contact</strong></td>
<td>The contact details to use if someone wants to contact you. Only necessary if <code>Swagger</code> is enabled.</td>
<td><em>user@example.com</em></td>
</tr>
<tr>
<td><strong>CompanyName</strong></td>
<td>The name of the company. Only necessary if <code>Swagger</code> is enabled.</td>
<td><em>mytechramblings</em></td>
</tr>
<tr>
<td><strong>CompanyWebsite</strong></td>
<td>The website of the comany. Only necessary if <code>Swagger</code> is enabled.</td>
<td><em><a href="http://www.mytechramblings.com">www.mytechramblings.com</a></em></td>
</tr>
<tr>
<td><strong>ApiDescription</strong></td>
<td>The description of the api. Only necessary if <code>Swagger</code> is enabled.</td>
<td><em>Put your api info here.</em></td>
</tr>
</tbody>
</table>
<ul>
<li>If you are working with Docker just set the <code>Docker</code> parameter to <code>true</code> and a Dockerfile will be placed alongside your api.</li>
<li>If you want to add some tests in your solution set the <code>Tests</code> parameter to <code>true</code>. A <code>/test</code> folder containing a unit test project and a integration test project will be added inside your solution.</li>
<li>If the api is going to be deployed with Azure Devops set the <code>AzurePipelines</code> parameter to true. A  <code>/pipelines</code> folder containing a YAML pipeline will be added inside your solution.</li>
<li>If the api is going to be deployed with GitHub set the <code>GitHub</code> parameter to true. A  <code>/.github</code> folder containing a GitHub Action will be added inside your solution.</li>
<li>Depending of how the api is going to be deployed set the <code>DeploymentType</code> parameter accordingly.
<ul>
<li>If you are going to deploy using containers set the value to <code>DeployAsContainer</code> and the deployment pipeline will be updated into a container deployment pipeline.</li>
<li>If you are going to deploy using a .zip file set the value to <code>DeployAsZip</code>, and the deployment pipeline will be updated into an artifact deployment pipeline.</li>
</ul>
</li>
<li>You can enable or disable features like <code>HealthChecks</code>or <code>Swagger</code>.</li>
<li>If you are using Authorization with Azure Active Directory, set the <code>Authorization</code> parameter to true and set the <code>AzureAdTenantId</code>, <code>AzureAdDomain</code>, <code>AzureAdClientId</code>, <code>AzureAdSecret</code> parameters accordingly.</li>
</ul>
<p>As can be seen from the table below there is also a default value for each parameter. A good tip when building a template with a lot of parameters is to set the default values to your most used scenario, so you won&rsquo;t need to set them every time you want to scaffold a new app.</p>
<p>After listing which features I wanted to parameterize, here&rsquo;s the <code>template.json</code> file:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="color:#e6db74">&#34;$schema&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;http://json.schemastore.org/template&#34;</span>,
    <span style="color:#e6db74">&#34;author&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;mytechramblings.com&#34;</span>,
    <span style="color:#e6db74">&#34;classifications&#34;</span><span style="color:#f92672">:</span> [
      <span style="color:#e6db74">&#34;Cloud&#34;</span>,
      <span style="color:#e6db74">&#34;Web&#34;</span>,
      <span style="color:#e6db74">&#34;WebAPI&#34;</span>
    ],
    <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;NET 5 WebApi&#34;</span>,
    <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;A WebApi solution.&#34;</span>,
    <span style="color:#e6db74">&#34;groupIdentity&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Dotnet.Custom.WebApi&#34;</span>,
    <span style="color:#e6db74">&#34;identity&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Dotnet.Custom.WebApi.CSharp&#34;</span>,
    <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;mtr-api&#34;</span>,
    <span style="color:#e6db74">&#34;defaultName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;WebApi1&#34;</span>,
    <span style="color:#e6db74">&#34;tags&#34;</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#34;language&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;C#&#34;</span>,
      <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;solution&#34;</span>
    },
    <span style="color:#e6db74">&#34;sourceName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ApplicationName&#34;</span>,
    <span style="color:#e6db74">&#34;preferNameDirectory&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
    <span style="color:#e6db74">&#34;primaryOutputs&#34;</span><span style="color:#f92672">:</span> [
        { <span style="color:#e6db74">&#34;path&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ApplicationName.sln&#34;</span> }
    ],
    <span style="color:#e6db74">&#34;sources&#34;</span><span style="color:#f92672">:</span> [
        {
          <span style="color:#e6db74">&#34;modifiers&#34;</span><span style="color:#f92672">:</span> [
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!Docker)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span>
                    [
                        <span style="color:#e6db74">&#34;Dockerfile&#34;</span>,
                        <span style="color:#e6db74">&#34;.dockerignore&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!ReadMe)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                        <span style="color:#e6db74">&#34;README.md&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!Tests)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                        <span style="color:#e6db74">&#34;test/ApplicationName.Library.Impl.UnitTest/**/*&#34;</span>,
                        <span style="color:#e6db74">&#34;test/ApplicationName.WebApi.IntegrationTest/**/*&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!GitHub)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                        <span style="color:#e6db74">&#34;.github/**/*&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!AzurePipelines)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                        <span style="color:#e6db74">&#34;pipelines/**/*&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!Swagger)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                      <span style="color:#e6db74">&#34;src/ApplicationName.WebApi/Extensions/ServiceCollectionExtensions/ServiceCollectionSwaggerExtension.cs&#34;</span>
                    ]
                },
                {
                    <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!HealthCheck)&#34;</span>,
                    <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
                    [
                      <span style="color:#e6db74">&#34;src/ApplicationName.WebApi/Extensions/ServiceCollectionExtensions/ServiceCollectionHealthChecksExtension.cs&#34;</span>,
                      <span style="color:#e6db74">&#34;src/ApplicationName.WebApi/Extensions/ApplicationBuilderExtensions/ApplicationBuilderWriteResponseExtension.cs&#34;</span>
                    ]
                }
            ]
        }
    ],
    <span style="color:#e6db74">&#34;symbols&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;Docker&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an optimised Dockerfile to add the ability to build a Docker image.&#34;</span>,
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>
        },
        <span style="color:#e6db74">&#34;ReadMe&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Add a README.md markdown file describing the project.&#34;</span>
        },
        <span style="color:#e6db74">&#34;Tests&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an integration project and unit test projects.&#34;</span>
        },
        <span style="color:#e6db74">&#34;GitHub&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds a GitHub action continuous integration pipeline.&#34;</span>,
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;false&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzurePipelines&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an Azure Pipelines YAML.&#34;</span>,
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>
        },
        <span style="color:#e6db74">&#34;DeploymentType&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
            <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;choice&#34;</span>,
            <span style="color:#e6db74">&#34;choices&#34;</span><span style="color:#f92672">:</span> [
              {
                <span style="color:#e6db74">&#34;choice&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsContainer&#34;</span>,
                <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The app will be deployed as a container.&#34;</span>
              },
              {
                <span style="color:#e6db74">&#34;choice&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsZip&#34;</span>,
                <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The app will be deployed as a zip file.&#34;</span>
              }
            ],
            <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsZip&#34;</span>,
            <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Select how you want to deploy the application.&#34;</span>
          },
        <span style="color:#e6db74">&#34;DeployContainer&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;computed&#34;</span>,
            <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(DeploymentType == \&#34;DeployAsContainer\&#34;)&#34;</span>
        },
        <span style="color:#e6db74">&#34;DeployZip&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;computed&#34;</span>,
            <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(DeploymentType == \&#34;DeployAsZip\&#34;)&#34;</span>
        },
      <span style="color:#e6db74">&#34;AcrName&#34;</span><span style="color:#f92672">:</span> {
          <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
          <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
          <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;acrcponsndev&#34;</span>,
          <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ACR-REGISTRY-NAME&#34;</span>,
          <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;An Azure ACR registry name. Only used if deploying with containers.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AzureSubscriptionName&#34;</span><span style="color:#f92672">:</span> {
          <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
          <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
          <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cponsn-dev-subscription&#34;</span>,
          <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AZURE-SUBSCRIPTION-ENDPOINT-NAME&#34;</span>,
          <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;An Azure Subscription Name. Only used if you are going to be deploying with Azure Pipelines.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AppServiceName&#34;</span><span style="color:#f92672">:</span> {
          <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
          <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
          <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;app-svc-demo-dev&#34;</span>,
          <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;APP-SERVICE-NAME&#34;</span>,
          <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The name of Azure App Service.&#34;</span>
      },
      <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enables the use of authorization with Microsoft.Identity.Web.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AzureAdTenantId&#34;</span><span style="color:#f92672">:</span>{
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;8a0671e2-3a30-4d30-9cb9-ad709b9c744a&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-TENANT-ID&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory Tenant Id. Only necessary if Authorization is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AzureAdDomain&#34;</span><span style="color:#f92672">:</span>{
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cpnoutlook.onmicrosoft.com&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-DOMAIN&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory Domain Name. Only necessary if Authorization is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AzureAdClientId&#34;</span><span style="color:#f92672">:</span>{
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;fdada45d-8827-466f-82a5-179724a3c268&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-CLIENT-ID&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory App Client Id. Only necessary if Authorization is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;AzureAdSecret&#34;</span><span style="color:#f92672">:</span>{
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;1234&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-SECRET-VALUE&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory App Secret Value. Only necessary if Authorization is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;HealthCheck&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enables the use of healthchecks.&#34;</span>
      },
      <span style="color:#e6db74">&#34;HealthCheckPath&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/health&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HEALTHCHECK-PATH&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HealthCheck path. Only necessary if HealthCheck is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;Swagger&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enable the use of Swagger.&#34;</span>
      },
      <span style="color:#e6db74">&#34;SwaggerPath&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;api-docs&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SWAGGER-PATH&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Swagger UI Path. Do not add a backslash. Only necessary if Swagger is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;Contact&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;user@example.com&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;API-CONTACT&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The contact details to use if someone wants to contact you. Only necessary if Swagger is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;CompanyName&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;mytechramblings&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMPANY-NAME&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The name of the company. Only necessary if Swagger is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;CompanyWebsite&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.mytechramblings.com&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;COMPANY-WEBSITE&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The website of the company. Needs to be a valid Uri. Only necessary if Swagger is enabled.&#34;</span>
      },
      <span style="color:#e6db74">&#34;ApiDescription&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
        <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
        <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Put your api info here&#34;</span>,
        <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;API-DESCRIPTION&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The description of the WebAPI. Only necessary if Swagger is enabled.&#34;</span>
      }
    },
    <span style="color:#e6db74">&#34;SpecialCustomOperations&#34;</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#34;**/*.yml&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;operations&#34;</span><span style="color:#f92672">:</span> [
              {
                <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;conditional&#34;</span>,
                <span style="color:#e6db74">&#34;configuration&#34;</span><span style="color:#f92672">:</span> {
                  <span style="color:#e6db74">&#34;if&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;#if&#34;</span> ],
                  <span style="color:#e6db74">&#34;else&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;#else&#34;</span> ],
                  <span style="color:#e6db74">&#34;elseif&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;#elseif&#34;</span> ],
                  <span style="color:#e6db74">&#34;endif&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;#endif&#34;</span> ],
                  <span style="color:#e6db74">&#34;actionableIf&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;##if&#34;</span> ],
                  <span style="color:#e6db74">&#34;actionableElse&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;##else&#34;</span> ],
                  <span style="color:#e6db74">&#34;actionableElseif&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;##elseif&#34;</span> ],
                  <span style="color:#e6db74">&#34;actions&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;uncomment&#34;</span>, <span style="color:#e6db74">&#34;reduceComment&#34;</span> ],
                  <span style="color:#e6db74">&#34;trim&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
                  <span style="color:#e6db74">&#34;wholeLine&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
                  <span style="color:#e6db74">&#34;evaluator&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;C++&#34;</span>
                }
              },
              {
                <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;replacement&#34;</span>,
                <span style="color:#e6db74">&#34;configuration&#34;</span><span style="color:#f92672">:</span> {
                  <span style="color:#e6db74">&#34;original&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;#&#34;</span>,
                  <span style="color:#e6db74">&#34;replacement&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span>,
                  <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;uncomment&#34;</span>
                }
              },
              {
                <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;replacement&#34;</span>,
                <span style="color:#e6db74">&#34;configuration&#34;</span><span style="color:#f92672">:</span> {
                  <span style="color:#e6db74">&#34;original&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;##&#34;</span>,
                  <span style="color:#e6db74">&#34;replacement&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;#&#34;</span>,
                  <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;reduceComment&#34;</span>
                }
              }
            ]
        }
    }
}
</code></pre></div><p>Let me make an in-depth rundown of the meaning of every value:</p>
<ul>
<li>
<p><code>author</code>: The author of the template.</p>
</li>
<li>
<p><code>classifications</code>: A set of characteristics of the template that a user might search for it.</p>
<ul>
<li>The classification items will appear as tags in the .NET CLI. You can search templates by classification using the <code>dotnet new --tag &lt;CLASSIFICATION_ITEM&gt;</code> command.</li>
<li>You can search templates by classification within Visual Studio using the <code>Project Type</code> dropdown.</li>
</ul>
</li>
<li>
<p><code>name</code>: The name of the template. That&rsquo;s the name that will appear in the .NET CLI and in VS.</p>
</li>
<li>
<p><code>description</code>:  The description of the template. The description will appear in the .NET CLI when you ran the <code>dotnet new &lt;TEMPLATE_NAME&gt; -h</code> command. In VS it will appear in the <code>Create new project dialog</code>.</p>
</li>
<li>
<p><code>groupIdentity</code>: The ID of the group this template belongs to.</p>
</li>
<li>
<p><code>identity</code>: A unique ID for this template.</p>
</li>
<li>
<p><code>shortName</code>: The short name is used for selecting the template in the .NET CLI. The <code>shortName</code> appears when you run <code>dotnet new -l</code> and it is probably the one that you will use the most when you create a new solution using the template. For example you could ceate a new solution using this api template running the <code>dotnet new mtr-api</code> command.<br>
Right now the <code>shortName</code> has no use in Visual Studio.</p>
</li>
<li>
<p><code>defaultName</code>: The name that will be used when you create a new solution using the template if no name has been specified.</p>
</li>
<li>
<p><code>tags</code>: You can add multiple tags but at least you have to specify the <code>language</code> tag and the <code>type</code> tag.</p>
<ul>
<li>The language tag specifies the programming language.</li>
<li>The type tag specifies the type of the template project. The possible values are: <code>project</code>, <code>solution</code>, <code>item</code>.</li>
</ul>
</li>
<li>
<p><code>sourceName</code>: The template engine will look for any occurrence of the <code>sourceName</code> and replace it. It will rename files if there is an occurrence. It will also replace file content if there is an occurrence.<br>
I&rsquo;m using  <code>ApplicationName</code> as the <code>sourceName</code> and naming every <code>.csproj</code> with the <code>ApplicationName</code> prefix:</p>
<ul>
<li><code>ApplicationName.sln</code></li>
<li><code>ApplicationName.WebApi.csproj</code></li>
<li><code>ApplicationName.Library.Contracts.csproj</code></li>
<li><code>ApplicationName.Library.Impl.csproj</code></li>
<li><code>ApplicationName.Repository.Contracts.csproj</code></li>
<li><code>ApplicationName.Repository.Impl.csproj</code></li>
</ul>
<p>When you create a new solution using this template every <code>.csproj</code> file and the <code>.sln</code> file will be renamed by the template engine from <code>ApplicationName</code> to the name chosen by the user.<br>
Also the namespace prefix inside all the <code>.csharp</code> files will be renamed from <code>ApplicationName</code> to the name chosen by the user.</p>
</li>
<li>
<p><code>preferNameDirectory</code>: Indicates whether to create a directory for the template. If you set the value to <code>false</code> the solution will be placed in your current directory.</p>
</li>
<li>
<p><code>specialCustomOperations</code>: The templating engine supports conditional operators, but it only supports them in a certain file types. If you want to use conditionals operators in another file types you need to add them here. <br>
In my template I want to add conditional operators on the YML files, that&rsquo;s why I&rsquo;m adding a custom operation that applies to all the yml files (<code>**/*.yml</code>)</p>
</li>
<li>
<p><code>sources.modifiers</code> : The sources.modifiers allows us to include or exclude files from the solution based on a condition.</p>
</li>
<li>
<p><code>symbols</code>: The symbols section is where you specify the inputs you want to parameterize and also define the behaviour of those inputs.</p>
</li>
</ul>
<p>The <code>symbols</code> section and the <code>sources.modifiers</code> section is the meat of the <code>template.json</code> file.</p>
<p>I&rsquo;m not going to try to explain the meaning of every symbol that I have placed on the <code>symbols</code> section, mainly because it will be quite repetitive because most of the symbols are using exactly the same strategy.<br>
Instead of that, I&rsquo;m going to explain the strategies I have used, so in the end every symbol from the <code>symbols</code> section will drop down in one of the strategies described in the next section.</p>
<h2 id="symbol-replacement"><strong>Symbol replacement</strong></h2>
<ul>
<li>Replaces a fixed string with the value of the symbol.</li>
</ul>
<p><strong>Example:</strong><br>
Here I have the symbol <code>HealthCheckPath</code> of type <code>parameter</code>. It has a default value of <code>/health</code> and a replace value of <code>HEALTHCHECK-VALUE</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  <span style="color:#e6db74">&#34;HealthCheckPath&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
    <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;string&#34;</span>,
    <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;/health&#34;</span>,
    <span style="color:#e6db74">&#34;replaces&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HEALTHCHECK-PATH&#34;</span>,
    <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HealthCheck path. Only necessary if HealthCheck is enabled.&#34;</span>
  }
</code></pre></div><p>When you try to create a new solution using this template:</p>
<ul>
<li>The template engine will try to find the <code>HEALTHCHECK-PATH</code> string anywhere in the template and if it finds it, it will be replaced either by the user input or the default value (<code>/health</code>). <br>
If you take a look at the <code>Startup.cs</code>, you&rsquo;ll see the <em><code>replaces</code></em> value is hard-coded in the template.</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp">   endpoints.MapHealthChecks(<span style="color:#e6db74">&#34;HEALTHCHECK-PATH&#34;</span>, <span style="color:#66d9ef">new</span> HealthCheckOptions
    {
      ResponseWriter = ApplicationBuilderWriteResponseExtension.WriteResponse
    });
</code></pre></div><p>When the user creates a new solution, the template engine will find the magic string <code>HEALTHCHECK-PATH</code> and replaced it by the user input or the <code>defaultValue</code>.</p>
<p>If you take a look at the symbols section from the  <code>template.json</code> file, you will find a lot of symbols using this very same strategy but with a different <code>replaces</code> value, this is because that&rsquo;s the easiest way to update certain parts of the source code with user inputs.</p>
<h2 id="use-conditional-operators-based-on-the-symbol-value"><strong>Use conditional operators based on the symbol value</strong></h2>
<ul>
<li>It allows us to skip entire chunks of code based on a symbol value.</li>
</ul>
<p><strong>Example:</strong><br>
Here I have the symbol <code>Authorization</code> of type <code>bool</code> with the default value of <code>true</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
    <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
    <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
    <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enables the use of authorization with Microsoft.Identity.Web.&#34;</span>
  },
</code></pre></div><ul>
<li>If the user sets the value to <code>false</code>, the template engine needs to remove any <code>Microsoft.Web.Identity</code> reference from the solution.</li>
<li>If the user sets this symbol to <code>true</code>, the template engine needs to keep the references to the <code>Microsoft.Web.Identity</code> library.</li>
</ul>
<p>If you take a look at the  <code>Startup.cs</code>, you&rsquo;ll see that all the <code>Microsoft.Web.Identity</code> references are being wrapped in a conditional operator.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75715e">#if Authorization
</span><span style="color:#75715e"></span><span style="color:#66d9ef">using</span> Microsoft.AspNetCore.Authentication.JwtBearer;
<span style="color:#66d9ef">using</span> Microsoft.Identity.Web;
<span style="color:#75715e">#endif
</span><span style="color:#75715e"></span>
...

<span style="color:#75715e">#if Authorization            
</span><span style="color:#75715e"></span>            services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)
                .AddMicrosoftIdentityWebApi(Configuration, <span style="color:#e6db74">&#34;AzureAd&#34;</span>);
<span style="color:#75715e">#endif
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#if Authorization
</span><span style="color:#75715e"></span>            app.UseAuthentication();
            app.UseAuthorization();
<span style="color:#75715e">#endif
</span></code></pre></div><p>The <code>Microsoft.Web.Identity</code> references are only being kept if the symbol <code>Authorization</code> is set to <code>true</code>.</p>
<p>But that&rsquo;s not enough, we need to remove the <code>Microsoft.Web.Identity</code> references from the <code>appsettings.json</code> file too.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
  <span style="color:#75715e">//#if (Authorization)  
</span><span style="color:#75715e"></span>  <span style="color:#e6db74">&#34;AzureAd&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;Instance&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://login.microsoftonline.com/&#34;</span>,
    <span style="color:#e6db74">&#34;TenantId&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-TENANT-ID&#34;</span>,
    <span style="color:#e6db74">&#34;Domain&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-DOMAIN&#34;</span>,
    <span style="color:#e6db74">&#34;ClientId&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-CLIENT-ID&#34;</span>,
    <span style="color:#e6db74">&#34;ClientSecret&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AAD-SECRET-VALUE&#34;</span>,
    <span style="color:#e6db74">&#34;TokenValidationParameters&#34;</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#34;ValidateIssuer&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
      <span style="color:#e6db74">&#34;ValidIssuer&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://login.microsoftonline.com/AAD-TENANT-ID/v2.0&#34;</span>,
      <span style="color:#e6db74">&#34;ValidateAudience&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>,
      <span style="color:#e6db74">&#34;ValidAudiences&#34;</span><span style="color:#f92672">:</span> [ <span style="color:#e6db74">&#34;AAD-CLIENT-ID&#34;</span> ]
    }
  }
  <span style="color:#75715e">//#endif
</span><span style="color:#75715e"></span>}
</code></pre></div><p>And also from the api controller:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75715e">#if Authorization
</span><span style="color:#75715e"></span><span style="color:#a6e22e">    [Authorize]</span>
<span style="color:#75715e">#endif
</span><span style="color:#75715e"></span><span style="color:#a6e22e">    [ApiVersion(&#34;1.0&#34;)]</span>
<span style="color:#a6e22e">    [ApiController]</span>
<span style="color:#a6e22e">    [ProducesResponseType(typeof(ErrorResult),  StatusCodes.Status400BadRequest)]</span>
<span style="color:#a6e22e">    [ProducesResponseType(typeof(ErrorResult),  StatusCodes.Status500InternalServerError)]</span>
<span style="color:#a6e22e">    [Route(&#34;v{version:apiVersion}/[controller]</span><span style="color:#e6db74">&#34;)]
</span><span style="color:#e6db74"></span><span style="color:#a6e22e">    [Produces(&#34;application/json&#34;)]</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MyServiceController</span> : ControllerBase
    {
    ...
    }

</code></pre></div><h2 id="use-a-symbol-value-to-compute-another-one"><strong>Use a symbol value to compute another one</strong></h2>
<ul>
<li>You can set the value of a symbol using the value of aonther one.</li>
</ul>
<p><strong>Example:</strong></p>
<p>The <code>DeploymentType</code> symbol is of type <code>choice</code> and with its value you can set the value of the <code>DeployContainer</code> symbol and the <code>DeployZip</code> symbol.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"> <span style="color:#e6db74">&#34;DeploymentType&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
    <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;choice&#34;</span>,
    <span style="color:#e6db74">&#34;choices&#34;</span><span style="color:#f92672">:</span> [
      {
        <span style="color:#e6db74">&#34;choice&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsContainer&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The app will be deployed as a container.&#34;</span>
      },
      {
        <span style="color:#e6db74">&#34;choice&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsZip&#34;</span>,
        <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The app will be deployed as a zip file.&#34;</span>
      }
    ],
    <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeployAsZip&#34;</span>,
    <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Select how you want to deploy the application.&#34;</span>
  },
  <span style="color:#e6db74">&#34;DeployContainer&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;computed&#34;</span>,
    <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(DeploymentType == \&#34;DeployAsContainer\&#34;)&#34;</span>
  },
  <span style="color:#e6db74">&#34;DeployZip&#34;</span><span style="color:#f92672">:</span> {
    <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;computed&#34;</span>,
    <span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(DeploymentType == \&#34;DeployAsZip\&#34;)&#34;</span>
  },
</code></pre></div><p>The <code>DeployContainer</code> symbol and the <code>DeployZip</code> symbol are used to tailor the deployment pipeline.</p>
<ul>
<li>If the user sets the <code>DeploymentType</code> symbol to <code>DeployAsContainer</code>,  then the <code>DeployContainer</code> symbol is set to <code>true</code>. <br>
The <code>DeployContainer</code> symbol value is used to create a deployment pipeline that will build and deploy a docker image.</li>
<li>If the user sets the <code>DeploymentType</code> symbol to <code>DeployAsZip</code>,  then the <code>DeployZip</code> symbol is set to <code>true</code>. <br>
The <code>DeployZip</code> symbol value is used to create a deployment pipeline that will build and deploy a zipped artifact.</li>
</ul>
<p>Take a look at how the Azure Pipelines YAML file uses the <code>DeployAsZip</code> and <code>DeployAsContainer</code> symbol value to add a specific pipeline type.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">trigger</span>:
- <span style="color:#ae81ff">master</span>

<span style="color:#f92672">pool</span>: 
  <span style="color:#f92672">vmImage</span>: <span style="color:#e6db74">&#39;ubuntu-latest&#39;</span>

<span style="color:#f92672">variables</span>:
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">buildConfiguration</span>
    <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#39;Release&#39;</span>
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">azureSubscription</span>
    <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#39;AZURE-SUBSCRIPTION-ENDPOINT-NAME&#39;</span>
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">appServiceName</span>
    <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#39;APP-SERVICE-NAME&#39;</span>
<span style="color:#75715e">#if (DeployContainer)</span>
  - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">registryName</span>
    <span style="color:#f92672">value</span>: <span style="color:#e6db74">&#39;ACR-REGISTRY-NAME&#39;</span>
<span style="color:#75715e">#endif</span>

<span style="color:#75715e">#if (DeployContainer)</span>
<span style="color:#f92672">steps</span>:
  - <span style="color:#f92672">task</span>: <span style="color:#ae81ff">AzureCLI@2</span>
    <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">AZ ACR Login</span>
    <span style="color:#f92672">inputs</span>:
      <span style="color:#f92672">azureSubscription</span>: <span style="color:#ae81ff">$(azureSubscription)</span>
      <span style="color:#f92672">scriptType</span>: <span style="color:#e6db74">&#39;bash&#39;</span>
      <span style="color:#f92672">scriptLocation</span>: <span style="color:#e6db74">&#39;inlineScript&#39;</span>
      <span style="color:#f92672">inlineScript</span>: <span style="color:#e6db74">&#39;az acr login --name $(registryName)&#39;</span>

  - <span style="color:#f92672">task</span>: <span style="color:#ae81ff">AzureCLI@2</span>
    <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">AZ ACR Build</span>
    <span style="color:#f92672">inputs</span>:
      <span style="color:#f92672">azureSubscription</span>: <span style="color:#ae81ff">$(azureSubscription)</span>
      <span style="color:#f92672">scriptType</span>: <span style="color:#e6db74">&#39;bash&#39;</span>
      <span style="color:#f92672">scriptLocation</span>: <span style="color:#e6db74">&#39;inlineScript&#39;</span>
      <span style="color:#f92672">inlineScript</span>: <span style="color:#e6db74">&#39;az acr build -t ApplicationName:$(Build.BuildId) -t ApplicationName:latest -r $(registryName) -f Dockerfile .&#39;</span>
      <span style="color:#f92672">useGlobalConfig</span>: <span style="color:#66d9ef">true</span>
      <span style="color:#f92672">workingDirectory</span>: <span style="color:#e6db74">&#39;$(Build.SourcesDirectory)&#39;</span>

  - <span style="color:#f92672">task</span>: <span style="color:#ae81ff">AzureWebAppContainer@1</span>
    <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Deploy to App Service</span>
    <span style="color:#f92672">inputs</span>:
      <span style="color:#f92672">azureSubscription</span>: <span style="color:#e6db74">&#39;$(azureSubscription)&#39;</span>
      <span style="color:#f92672">appName</span>: <span style="color:#e6db74">&#39;$(appServiceName)&#39;</span>
      <span style="color:#f92672">containers</span>: <span style="color:#e6db74">&#39;$(registryName).azurecr.io/ApplicationName:latest&#39;</span>
<span style="color:#75715e">#endif</span>

<span style="color:#75715e">#if (DeployZip)</span>
<span style="color:#f92672">steps</span>:
- <span style="color:#f92672">task</span>: <span style="color:#ae81ff">DotNetCoreCLI@2</span>
  <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Restore</span>
  <span style="color:#f92672">inputs</span>:
    <span style="color:#f92672">command</span>: <span style="color:#e6db74">&#39;restore&#39;</span>
    <span style="color:#f92672">projects</span>: <span style="color:#e6db74">&#39;**/*.csproj&#39;</span>

- <span style="color:#f92672">task</span>: <span style="color:#ae81ff">DotNetCoreCLI@2</span>
  <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Build</span>
  <span style="color:#f92672">inputs</span>:
    <span style="color:#f92672">command</span>: <span style="color:#e6db74">&#39;build&#39;</span>
    <span style="color:#f92672">projects</span>: <span style="color:#e6db74">&#39;**/*.csproj&#39;</span>
    <span style="color:#f92672">arguments</span>: <span style="color:#e6db74">&#39;--configuration $(buildConfiguration) --no-restore&#39;</span>

- <span style="color:#f92672">task</span>: <span style="color:#ae81ff">DotNetCoreCLI@2</span>
  <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Test</span>
  <span style="color:#f92672">inputs</span>:
    <span style="color:#f92672">command</span>: <span style="color:#e6db74">&#39;test&#39;</span>
    <span style="color:#f92672">projects</span>: <span style="color:#e6db74">&#39;**/*UnitTest.csproj&#39;</span>
    <span style="color:#f92672">arguments</span>: <span style="color:#e6db74">&#39;--configuration $(buildConfiguration) --no-restore&#39;</span>

- <span style="color:#f92672">task</span>: <span style="color:#ae81ff">DotNetCoreCLI@2</span>
  <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Publish</span>
  <span style="color:#f92672">inputs</span>:
    <span style="color:#f92672">command</span>: <span style="color:#ae81ff">publish</span>
    <span style="color:#f92672">publishWebProjects</span>: <span style="color:#66d9ef">false</span>
    <span style="color:#f92672">projects</span>: <span style="color:#e6db74">&#39;**/ApplicationName.WebApi.csproj&#39;</span>
    <span style="color:#f92672">arguments</span>: <span style="color:#e6db74">&#39;--configuration $(BuildConfiguration) --output $(Build.ArtifactStagingDirectory)&#39;</span>
    <span style="color:#f92672">zipAfterPublish</span>: <span style="color:#66d9ef">True</span>

- <span style="color:#f92672">task</span>: <span style="color:#ae81ff">AzureWebApp@1</span>
  <span style="color:#f92672">displayName</span>: <span style="color:#ae81ff">Deploy Azure Web App</span>
  <span style="color:#f92672">inputs</span>:
    <span style="color:#f92672">azureSubscription</span>: <span style="color:#e6db74">&#39;$(azureSubscription)&#39;</span>
    <span style="color:#f92672">appName</span>: <span style="color:#e6db74">&#39;$(appServiceName)&#39;</span>
    <span style="color:#f92672">appType</span>: <span style="color:#e6db74">&#39;webApp&#39;</span>
    <span style="color:#f92672">package</span>: <span style="color:#ae81ff">$(Build.ArtifactStagingDirectory)/**/*.zip</span>
<span style="color:#75715e">#endif</span>
</code></pre></div><p>Take a look at how the GitHub Action YAML file uses the <code>DeployAsZip</code> and <code>DeployAsContainer</code> symbol value to add a specific pipeline type.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">name</span>: <span style="color:#ae81ff">.NET api deploy to Azure App Service</span>

<span style="color:#f92672">on</span>:
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>

<span style="color:#f92672">env</span>:
  <span style="color:#f92672">AZURE_WEBAPP_NAME</span>: <span style="color:#ae81ff">APP-SERVICE-NAME   </span>
<span style="color:#75715e">#if (DeployContainer)</span>
  <span style="color:#f92672">CONTAINER_REGISTRY</span>: <span style="color:#ae81ff">ACR-REGISTRY-NAME.azurecr.io </span>
<span style="color:#75715e">#endif</span>

<span style="color:#75715e">#if (DeployContainer)</span>
<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">build-and-deploy-to-dev</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">environment</span>: <span style="color:#ae81ff">dev</span>
    <span style="color:#f92672">steps</span>:
    <span style="color:#75715e"># Checkout the repo</span>
    - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@master</span>

    <span style="color:#75715e"># Authenticate to Azure</span>
    - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;Azure authentication&#39;</span>
      <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">azure/login@v1</span>
      <span style="color:#f92672">with</span>:
        <span style="color:#f92672">creds</span>: <span style="color:#ae81ff">${{ secrets.AZURE_CREDENTIALS }}</span>
 
    <span style="color:#75715e"># Authenticate to ACR</span>
    - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;ACR authentication&#39;</span>
      <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">azure/docker-login@v1</span>
      <span style="color:#f92672">with</span>:
        <span style="color:#f92672">login-server</span>: <span style="color:#ae81ff">${{ env.CONTAINER_REGISTRY }}</span>
        <span style="color:#f92672">username</span>: <span style="color:#ae81ff">${{ secrets.REGISTRY_USERNAME }}</span>
        <span style="color:#f92672">password</span>: <span style="color:#ae81ff">${{ secrets.REGISTRY_PASSWORD }} </span>

    <span style="color:#75715e"># Build and push the Docker image</span>
    - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;Docker Build &amp; Push to ACR&#39;</span>
      <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">        docker build . -t ${{ env.CONTAINER_REGISTRY }}/ApplicationName:${{ github.sha }}
</span><span style="color:#e6db74">        docker push ${{ env.CONTAINER_REGISTRY }}/ApplicationName:${{ github.sha }} </span>        

    <span style="color:#75715e"># Deploy to Azure</span>
    - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;Deploy to Azure Web App for Container&#39;</span>
      <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">azure/webapps-deploy@v2</span>
      <span style="color:#f92672">with</span>: 
        <span style="color:#f92672">app-name</span>: <span style="color:#ae81ff">${{ env.AZURE_WEBAPP_NAME }} </span>
        <span style="color:#f92672">images</span>: <span style="color:#ae81ff">${{ env.CONTAINER_REGISTRY }}/ApplicationName:${{ github.sha }}</span>
<span style="color:#75715e">#endif</span>

<span style="color:#75715e">#if (DeployZip)</span>
<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">build-and-deploy</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-latest</span>
    <span style="color:#f92672">environment</span>: <span style="color:#ae81ff">dev</span>
    <span style="color:#f92672">steps</span>:
      <span style="color:#75715e"># Checkout the repo</span>
      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@master</span>
      
      <span style="color:#75715e"># Setup .NET Core SDK</span>
      - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;Setup .NET Core&#39;</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-dotnet@v1</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">dotnet-version</span>: <span style="color:#e6db74">&#39;5.0.x&#39;</span>
      
      <span style="color:#75715e"># Run dotnet build and publish</span>
      - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;dotnet build and publish&#39;</span>
        <span style="color:#f92672">run</span>: |<span style="color:#e6db74">
</span><span style="color:#e6db74">          dotnet restore
</span><span style="color:#e6db74">          dotnet build --configuration Release
</span><span style="color:#e6db74">          dotnet publish -c Release -o ${{ github.workspace }}/.output
</span><span style="color:#e6db74">          </span>          
      <span style="color:#75715e"># Deploy to Azure Web apps</span>
      - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#39;Run Azure webapp deploy action using publish profile credentials&#39;</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">azure/webapps-deploy@v2</span>
        <span style="color:#f92672">with</span>: 
          <span style="color:#f92672">app-name</span>: <span style="color:#ae81ff">${{ env.AZURE_WEBAPP_NAME }}</span> <span style="color:#75715e"># Replace with your app name</span>
          <span style="color:#f92672">publish-profile</span>: <span style="color:#ae81ff">${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE  }}</span> <span style="color:#75715e"># Define secret variable in repository settings as per action documentation</span>
          <span style="color:#f92672">package</span>: <span style="color:#ae81ff">${{ github.workspace }}/.output</span>
<span style="color:#75715e">#endif</span>
</code></pre></div><h2 id="excluding-files-based-on-a-symbol-value"><strong>Excluding files based on a symbol value</strong></h2>
<ul>
<li>The <code>source.modifiers</code> section can be combined with the <code>symbols</code> section to include or exclude existing files based on a symbol value.</li>
</ul>
<p><strong>Example 1:</strong></p>
<p>The <code>Dockerfile</code> symbol is of type <code>parameter</code> and the default value is <code>true</code>.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  <span style="color:#e6db74">&#34;Docker&#34;</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
      <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
      <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an optimised Dockerfile to add the ability to build a Docker image.&#34;</span>,
      <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>
  }
</code></pre></div><ul>
<li>If the symbol value is set to <code>false</code>, the template engine needs to remove the <code>Dockerfile</code> and the <code>.dockerignore</code> files from the solution.</li>
<li>If the symbol value is set to <code>true</code>, the template engine needs to keep both files.</li>
</ul>
<p>To achieve the desired behaviour, you can add the following object inside the <code>source.modifiers</code> array.<br>
The <code>Docker</code> symbol value is used as the condition to exclude both files.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  {
      <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!Docker)&#34;</span>,
      <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span>
      [
          <span style="color:#e6db74">&#34;Dockerfile&#34;</span>,
          <span style="color:#e6db74">&#34;.dockerignore&#34;</span>
      ]
  }
</code></pre></div><p>The template engine will remove the <code>Dockerfile</code> and the <code>.dockerignore</code> files, if the value of the <code>Docker</code> symbol equals to <code>false</code>.</p>
<p><strong>Example 2:</strong></p>
<p>This is a more interesting example. The <code>Test</code> symbol is of type <code>parameter</code> and the default value is <code>true</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  <span style="color:#e6db74">&#34;Tests&#34;</span><span style="color:#f92672">:</span> {
      <span style="color:#e6db74">&#34;type&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;parameter&#34;</span>,
      <span style="color:#e6db74">&#34;datatype&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bool&#34;</span>,
      <span style="color:#e6db74">&#34;defaultValue&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;true&#34;</span>,
      <span style="color:#e6db74">&#34;description&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an integration and unit test projects.&#34;</span>
  }
</code></pre></div><ul>
<li>If the symbol value is set to <code>false</code>, the template engine needs to:
<ul>
<li>Remove the folder that contains the unit test project from the solution.</li>
<li>Remove the folder that contains the integration test project from the solution.</li>
<li>Remove the test project references from the <code>.sln</code> file.</li>
</ul>
</li>
<li>If the symbol value is set to <code>true</code>, the template engines needs to keep the test projects.</li>
</ul>
<p>To achieve the desired behaviour, you can add the following object in the <code>source.modifiers</code> array.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">  {
      <span style="color:#e6db74">&#34;condition&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;(!Tests)&#34;</span>,
      <span style="color:#e6db74">&#34;exclude&#34;</span><span style="color:#f92672">:</span> 
      [
          <span style="color:#e6db74">&#34;test/ApplicationName.Library.Impl.UnitTest/**/*&#34;</span>,
          <span style="color:#e6db74">&#34;test/ApplicationName.WebApi.IntegrationTest/**/*&#34;</span>
      ]
  },
</code></pre></div><p>The <code>Tests</code> symbol value is used as the condition to exclude both test folders.<br>
Also the <code>Tests</code> symbol is used to remove the test project references from the <code>.sln</code> file via a conditional operator.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-csharp" data-lang="csharp"><span style="color:#75715e">#if (Tests)
</span><span style="color:#75715e"></span>Project(<span style="color:#e6db74">&#34;{2150E333-8FDC-42A3-9474-1A3956D46DE8}&#34;</span>) = <span style="color:#e6db74">&#34;Test&#34;</span>, <span style="color:#e6db74">&#34;Test&#34;</span>, <span style="color:#e6db74">&#34;{0323DDF8-0F80-4DF1-8F12-C37353534337}&#34;</span>
EndProject
<span style="color:#75715e">#endif
</span><span style="color:#75715e"></span>...
<span style="color:#75715e">#if (Tests)
</span><span style="color:#75715e"></span>Project(<span style="color:#e6db74">&#34;{9A19103F-16F7-4668-BE54-9A1E7A4F7556}&#34;</span>) = <span style="color:#e6db74">&#34;ApplicationName.WebApi.IntegrationTest&#34;</span>, <span style="color:#e6db74">&#34;test\ApplicationName.WebApi.IntegrationTest\ApplicationName.WebApi.IntegrationTest.csproj&#34;</span>, <span style="color:#e6db74">&#34;{205B0B75-C24F-40E4-BA69-46AE61CF9C20}&#34;</span>
EndProject
Project(<span style="color:#e6db74">&#34;{9A19103F-16F7-4668-BE54-9A1E7A4F7556}&#34;</span>) = <span style="color:#e6db74">&#34;ApplicationName.Library.Impl.UnitTest&#34;</span>, <span style="color:#e6db74">&#34;test\ApplicationName.Library.Impl.UnitTest\ApplicationName.Library.Impl.UnitTest.csproj&#34;</span>, <span style="color:#e6db74">&#34;{C22AA50D-81CC-4A9B-9926-7AB8445246A9}&#34;</span>
EndProject
<span style="color:#75715e">#endif
</span></code></pre></div><h2 id="22-create-the-dotnetclihostjson-file">2.2. <strong>Create the dotnetcli.host.json file</strong></h2>
<p>If your template needs some command line parameters you can customize them by adding a <code>dotnetcli.host.json</code> file inside the <code>.template.config</code> folder.</p>
<p>In the <code>dotnetcli.host.json</code> file you can specify the short and long names for each of the command line parameters.</p>
<p>This step is not mandatory and in my case I have quite a sizeable list of parameters to customize, but nonetheless I prefer to customize each parameter name as I see fit.<br>
Here&rsquo;s how the <code>dotnetcli.host.json</code> looks:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="color:#e6db74">&#34;$schema&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;http://json.schemastore.org/dotnetcli.host&#34;</span>,
    <span style="color:#e6db74">&#34;symbolInfo&#34;</span><span style="color:#f92672">:</span>
    {
        <span style="color:#e6db74">&#34;Docker&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;dockerfile&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;d&#34;</span>
        },
        <span style="color:#e6db74">&#34;ReadMe&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;readme&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;r&#34;</span>
        },
        <span style="color:#e6db74">&#34;Tests&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;tests&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;t&#34;</span>
        },
        <span style="color:#e6db74">&#34;GitHub&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;github&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ga&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzurePipelines&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;azure-pipelines&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ap&#34;</span>
        },
        <span style="color:#e6db74">&#34;DeploymentType&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;deploy-type&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;dt&#34;</span>
        },
        <span style="color:#e6db74">&#34;AcrName&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;acr-name&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;acr&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzureSubscriptionName&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;azure-subscription&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;az&#34;</span>
        },
        <span style="color:#e6db74">&#34;AppServiceName&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;app-service-name&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;asn&#34;</span>
        },
        <span style="color:#e6db74">&#34;Authorization&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;authorization&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;auth&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzureAdTenantId&#34;</span><span style="color:#f92672">:</span>{
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;aad-tenant-id&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;at&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzureAdDomain&#34;</span><span style="color:#f92672">:</span>{
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;aad-domain-name&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ad&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzureAdClientId&#34;</span><span style="color:#f92672">:</span>{
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;aad-client-id&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ac&#34;</span>
        },
        <span style="color:#e6db74">&#34;AzureAdSecret&#34;</span><span style="color:#f92672">:</span>{
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;aad-secret-value&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;as&#34;</span>
        },
        <span style="color:#e6db74">&#34;HealthCheck&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;healthcheck&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;hck&#34;</span>
        },
        <span style="color:#e6db74">&#34;HealthCheckPath&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;healthcheck-path&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;hp&#34;</span>
        },
        <span style="color:#e6db74">&#34;Swagger&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;swagger&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;s&#34;</span>
        },
        <span style="color:#e6db74">&#34;SwaggerPath&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;swagger-path&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;sp&#34;</span>
        },
        <span style="color:#e6db74">&#34;Contact&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;contact-mail&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cm&#34;</span>
        },
        <span style="color:#e6db74">&#34;CompanyName&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;company-name&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cn&#34;</span>
        },
        <span style="color:#e6db74">&#34;CompanyWebsite&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;company-website&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;cw&#34;</span>
        },
        <span style="color:#e6db74">&#34;ApiDescription&#34;</span><span style="color:#f92672">:</span> {
            <span style="color:#e6db74">&#34;longName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;api-description&#34;</span>,
            <span style="color:#e6db74">&#34;shortName&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;desc&#34;</span>
        }
    }
}
</code></pre></div><p>Remember that there are default values defined in the <code>template.json</code> file for each parameter, so you don&rsquo;t have to specify each and every one of the command line parameters if you don&rsquo;t need to.</p>
<p>If you want to create a solution using the default values an override only a couple of parameters, you could totally do it.<br>
For example, this command: <code>dotnet new mtr-api --github true --azure-pipelines false</code> will create an api solution using the default values for every command line parameter except the <code>github</code> and <code>azure-pipelines</code> parameters.</p>
<h2 id="23-create-the-idehostjson-file">2.3. <strong>Create the ide.host.json file</strong></h2>
<p>If your template needs some command line parameters and you want to use it within Visual Studio you need to add an <code>ide.host.json</code> file inside the <code>.template.config</code> folder.</p>
<p>This file will be used to show the command line parameters inside a project dialog when you try to create a new project.</p>
<p><img src="/img/dotnet-api-template-vs-dialog.png" alt="api-vs-dialog"></p>
<p>Also you can customize your templates appearance in the Visual Studio template list with an icon. If it is not provided, a default icon will be associated with your project template.</p>
<p>Here&rsquo;s how the <code>ide.host.json</code> for the api looks like:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">{
    <span style="color:#e6db74">&#34;$schema&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;http://json.schemastore.org/vs-2017.3.host&#34;</span>,
    <span style="color:#e6db74">&#34;order&#34;</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>,
    <span style="color:#e6db74">&#34;icon&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;icon.png&#34;</span>,
    <span style="color:#e6db74">&#34;symbolInfo&#34;</span><span style="color:#f92672">:</span> [
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Docker&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds a Dockerfile.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ReadMe&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds a Readme.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Tests&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds a Unit Test project and a Integration Test project.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;GitHub&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds a GitHub action to deploy the application.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzurePipelines&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Adds an Azure Pipeline YAML to deploy the application.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;DeploymentType&#34;</span>,
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AcrName&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Name of the ACR Registry, only used if deploying with container.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzureSubscriptionName&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;An Azure subscription service endpoint name, only used if deploying with Azure DevOps.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AppServiceName&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The name of Azure App Service.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Authorization&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enable the use of authorization with Microsoft.Identity.Web.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzureAdTenantId&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory Tenant Id. Only necessary if Authorization is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzureAdDomain&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory Domain Name. Only necessary if Authorization is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzureAdClientId&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory App Client Id. Only necessary if Authorization is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;AzureAdSecret&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Azure Active Directory App Secret Value. Only necessary if Authorization is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HealthCheck&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enable the use of healthchecks.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HealthCheckPath&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;HealthCheck path. Only necessary if HealthCheck is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Swagger&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Enable the use of Swagger.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;SwaggerPath&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Swagger UI Path. Only necessary if Swagger is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Contact&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The contact details to use if someone wants to contact you. Only necessary if Swagger is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CompanyName&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The name of the company. Only necessary if Swagger is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;CompanyWebsite&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The website of the company. Needs to be a valid Uri. Only necessary if Swagger is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      },
      {       
        <span style="color:#e6db74">&#34;id&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;ApiDescription&#34;</span>,
        <span style="color:#e6db74">&#34;name&#34;</span><span style="color:#f92672">:</span> 
        {
          <span style="color:#e6db74">&#34;text&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;The description of the WebAPI. Only necessary if Swagger is enabled.&#34;</span>
        },
        <span style="color:#e6db74">&#34;isVisible&#34;</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>      
      }
    ]
}
</code></pre></div><h1 id="3-convert-the-remaining-2-apps-into-templates">3. Convert the remaining 2 apps into templates</h1>
<ul>
<li>We still need to convert the <code>Worker Service</code> application and the <code>Azure Function</code> into a .NET template.</li>
</ul>
<p>The conversion process is exactly the same as the one described for the webapi, so I&rsquo;m not going to bother writing about it or this post is going to drag on forever.</p>
<p>In both case the <code>template.json</code> file is quite similar, if you&rsquo;re interested in the end result:</p>
<ul>
<li>Here`s the <a href="https://github.com/karlospn/MyTechRamblings.Templates/blob/main/src/HostedServiceNet5RabbitConsumerTemplate/.template.config/template.json">link</a> to the <code>template.json</code> file for the <code>Worker Service</code> application.</li>
<li>Here&rsquo;s the <a href="https://github.com/karlospn/MyTechRamblings.Templates/blob/main/src/AzureFunctionTimerProjectTemplate/.template.config/template.json">link</a> to the <code>template.json</code> file for the <code>Azure Function</code>.</li>
</ul>
<h1 id="4-create-the-mytechramblingstemplates-nuget-package">4. Create the MyTechRamblings.Templates NuGet package</h1>
<p>In <strong>Part 1</strong> I told you that there are a couple of ways for creating a template pack:</p>
<ul>
<li>Using a <code>.csproj</code> file and the <code>dotnet pack</code> command.</li>
<li>Using a <code>.nuspec</code> file and the <code>nuget pack</code> command from <code>nuget.exe</code>.</li>
</ul>
<p>I&rsquo;m using a <code>.nuspec</code> file. It looks like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#75715e">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
<span style="color:#f92672">&lt;package&gt;</span>
  <span style="color:#f92672">&lt;metadata&gt;</span>
    <span style="color:#f92672">&lt;id&gt;</span>MyTechRamblings.Templates<span style="color:#f92672">&lt;/id&gt;</span>
    <span style="color:#f92672">&lt;version&gt;</span>0.5.0<span style="color:#f92672">&lt;/version&gt;</span>
    <span style="color:#f92672">&lt;description&gt;</span>This nuget is an example about how to pack multiple dotnet templates in a single NuGet package and use it within Visual Studio or the .NET CLI.<span style="color:#f92672">&lt;/description&gt;</span>
    <span style="color:#f92672">&lt;authors&gt;</span>Carlos Pons (www.mytechramblings.com)<span style="color:#f92672">&lt;/authors&gt;</span>
    <span style="color:#f92672">&lt;title&gt;</span>MyTechRamblings Dotnet Templates<span style="color:#f92672">&lt;/title&gt;</span>
    <span style="color:#f92672">&lt;copyright&gt;</span>Copyright 2021: www.mytechramblings.com. All right Reserved<span style="color:#f92672">&lt;/copyright&gt;</span>
    <span style="color:#f92672">&lt;requireLicenseAcceptance&gt;</span>false<span style="color:#f92672">&lt;/requireLicenseAcceptance&gt;</span>
    <span style="color:#f92672">&lt;license</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;expression&#34;</span><span style="color:#f92672">&gt;</span>MIT<span style="color:#f92672">&lt;/license&gt;</span>
    <span style="color:#f92672">&lt;tags&gt;</span>.NET WebApi Rabbit Function Templates<span style="color:#f92672">&lt;/tags&gt;</span>
    <span style="color:#f92672">&lt;projectUrl&gt;</span>https://github.com/karlospn/MyTechRamblings.Templates<span style="color:#f92672">&lt;/projectUrl&gt;</span>
    <span style="color:#f92672">&lt;repository</span> <span style="color:#a6e22e">type=</span><span style="color:#e6db74">&#34;git&#34;</span> <span style="color:#a6e22e">url=</span><span style="color:#e6db74">&#34;https://github.com/karlospn/MyTechRamblings.Templates.git&#34;</span> <span style="color:#a6e22e">branch=</span><span style="color:#e6db74">&#34;main&#34;</span>  <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;language&gt;</span>en-US<span style="color:#f92672">&lt;/language&gt;</span>
	<span style="color:#f92672">&lt;packageTypes&gt;</span>
      <span style="color:#f92672">&lt;packageType</span> <span style="color:#a6e22e">name=</span><span style="color:#e6db74">&#34;Template&#34;</span> <span style="color:#f92672">/&gt;</span>
    <span style="color:#f92672">&lt;/packageTypes&gt;</span>
  <span style="color:#f92672">&lt;/metadata&gt;</span>
  <span style="color:#f92672">&lt;files&gt;</span>
    <span style="color:#f92672">&lt;file</span> <span style="color:#a6e22e">src=</span><span style="color:#e6db74">&#34;**&#34;</span> <span style="color:#a6e22e">exclude=</span><span style="color:#e6db74">&#34;**\bin\**\*;**\obj\**\*;**\*.user;**\*.lock.json;_rels\**\*;package\**\*&#34;</span> <span style="color:#f92672">/&gt;</span>
  <span style="color:#f92672">&lt;/files&gt;</span>
<span style="color:#f92672">&lt;/package&gt;</span>
</code></pre></div><h1 id="5-publish-the-package-to-nugetspanorg">5. Publish the package to nuget<span>.org</h1>
<p>I don&rsquo;t want to  create and publish the package manually.<br>
Instead of that, I have created a <code>Powershell</code> script that fetches the nuget executable from the <code>nuget.org</code> website, bundles everything together and creates the pack using the <code>nuget pack</code> command.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Set-StrictMode -Version Latest
$templateName <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;template&#34;</span>
$templatePath <span style="color:#f92672">=</span>     <span style="color:#e6db74">&#34;./</span>$templateName<span style="color:#e6db74">/mtr&#34;</span>
$contentDirectory <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./</span>$templateName<span style="color:#e6db74">/mtr/content&#34;</span>
$nugetPath <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;./</span>$templateName<span style="color:#e6db74">/nuget.exe&#34;</span>
$nugetOut <span style="color:#f92672">=</span>  <span style="color:#e6db74">&#34;./</span>$templateName<span style="color:#e6db74">/nuget&#34;</span>
$nugetUrl <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;https://dist.nuget.org/win-x86-commandline/v5.9.1/nuget.exe&#34;</span>


Write-Output <span style="color:#e6db74">&#34;Copy WebApiNet5 template&#34;</span>
Copy-Item -Path <span style="color:#e6db74">&#34;./src/WebApiNet5Template&#34;</span> -Recurse -Destination <span style="color:#e6db74">&#34;</span>$contentDirectory<span style="color:#e6db74">/WebApiNet5Template&#34;</span> -Container

Write-Output <span style="color:#e6db74">&#34;Copy HostedServiceNet5RabbitConsumer template&#34;</span>
Copy-Item -Path <span style="color:#e6db74">&#34;./src/HostedServiceNet5RabbitConsumerTemplate&#34;</span> -Recurse -Destination <span style="color:#e6db74">&#34;</span>$contentDirectory<span style="color:#e6db74">/HostedServiceNet5RabbitConsumerTemplate&#34;</span> -Container

Write-Output <span style="color:#e6db74">&#34;Copy AzureFunctionTimerProjectTemplate template&#34;</span>
Copy-Item -Path <span style="color:#e6db74">&#34;./src/AzureFunctionTimerProjectTemplate&#34;</span> -Recurse -Destination <span style="color:#e6db74">&#34;</span>$contentDirectory<span style="color:#e6db74">/AzureFunctionTimerProjectTemplate&#34;</span> -Container

Write-Output <span style="color:#e6db74">&#34;Copy nuspec&#34;</span>
Copy-item -Force -Recurse <span style="color:#e6db74">&#34;MyTechRamblings.Templates.nuspec&#34;</span> -Destination $templatePath

Write-Output <span style="color:#e6db74">&#34;Download nuget.exe from </span>$nugetUrl<span style="color:#e6db74">&#34;</span>
Invoke-WebRequest -Uri $nugetUrl -OutFile $nugetPath

Write-Output <span style="color:#e6db74">&#34;Pack nuget&#34;</span>
$cmdArgList <span style="color:#f92672">=</span> @<span style="color:#f92672">(</span> <span style="color:#e6db74">&#34;pack&#34;</span>, <span style="color:#e6db74">&#34;</span>$templatePath<span style="color:#e6db74">\MyTechRamblings.Templates.nuspec&#34;</span>,
				 <span style="color:#e6db74">&#34;-OutputDirectory&#34;</span>, <span style="color:#e6db74">&#34;</span>$nugetOut<span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;-NoDefaultExcludes&#34;</span><span style="color:#f92672">)</span>
&amp; $nugetPath $cmdArgList 
</code></pre></div><p>And also I have created a GitHub Action that executes the script and pushes the <code>.nupkg</code> into the <code>nuget.org</code> feed.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#f92672">name</span>: <span style="color:#ae81ff">push the template package to nuget.org</span>

<span style="color:#f92672">on</span>:
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">main ]</span>
  <span style="color:#f92672">pull_request</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">main ]</span>

  <span style="color:#f92672">workflow_dispatch</span>:

<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">build</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">windows-latest</span>
    <span style="color:#f92672">steps</span>: 
      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v2</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Setup .NET Core</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/setup-dotnet@v1</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">dotnet-version</span>: <span style="color:#ae81ff">5.0</span><span style="color:#ae81ff">.x</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Create nupkg</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">.\create-nuget.ps1</span>
        <span style="color:#f92672">shell</span>: <span style="color:#ae81ff">powershell</span>
      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Push to Nuget.org</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">dotnet nuget push &#34;**/*.nupkg&#34; -k ${{ secrets.NUGET_API_KEY }} -s https://api.nuget.org/v3/index.json --skip-duplicate</span>
</code></pre></div><h1 id="6-install-and-use-the-mytechramblingstemplates-with-the-net-cli">6. Install and use the MyTechRamblings.Templates with the .NET CLI</h1>
<p>To Install the package you can run this command:</p>
<ul>
<li><code>dotnet new -i MyTechRamblings.Templates::0.5.0</code></li>
</ul>
<p>The command will try to fetch the NuGet from <code>nuget.org</code> and install it.</p>
<p>Or if you have the .nupkg in your local filesystem, you can ran this command:</p>
<ul>
<li><code>dotnet new -i .\MyTechRamblings.Templates.0.5.0.nupkg</code></li>
</ul>
<p>After installing the templates pack you should run the <code>dotnet new -l</code> command and verify that the 3 templates appear on the list (<code>mtr-api</code>, <code>mtr-rabbit-worker</code>, <code>mtr-az-func-timer</code>).</p>
<p><img src="/img/dotnet-list-installed-templates.png" alt="dotnet-list-templates"></p>
<p>Now you can create a new solution running any of these commands:</p>
<ul>
<li><code>dotnet new mtr-api</code></li>
<li><code>dotnet new mtr-rabbit-worker</code></li>
<li><code>dotnet new mtr-az-func-timer</code></li>
</ul>
<p>This commands will create a solution using the default values. If you want to set a specific parameter execute the <code>dotnet new</code> command with the <code>-h</code> flag to list every command line  parameter available.</p>
<h1 id="7-use-the-mytechramblingstemplates-within-visual-studio">7. Use the MyTechRamblings.Templates within Visual Studio</h1>
<blockquote>
<p>Be sure to enable the following option in Visual Studio: <code>Tools &gt; Options &gt; Preview Features &gt; Show all .NET Core templates in the New Project dialog</code>.<br>
And remember:</p>
<ul>
<li><strong>The MyTechRamblings.Templates package contains a couple of solution templates ( the api template and the worker template). If you want to use them you need at least Visual Studio version 16.10 or higher.</strong></li>
</ul>
</blockquote>
<p>Try to create a new project withing Visual Studio and the new templates should appear in the <code>Create a new project</code> dialog.<br>
If the templates doesn&rsquo;t show up, just search for them in the search box.</p>
<p><img src="/img/dotnet-vs-list-templates.png" alt="list-templates"></p>
<p>If you select any of the templates a dialog will show up and it will contain every parameter that you have specified in the <code>ide.host.json</code>.</p>
<ul>
<li>WebAPI Visual Studio dialog:</li>
</ul>
<p><img src="/img/dotnet-api-template-vs-dialog.png" alt="api-vs-dialog"></p>
<ul>
<li>Worker Service Visual Studio dialog:</li>
</ul>
<p><img src="/img/dotnet-worker-template-vs-dialog.png" alt="worker-vs-dialog"></p>
<ul>
<li>Azure function Visual Studio dialog:</li>
</ul>
<p><img src="/img/dotnet-function-template-vs-dialog.png" alt="function-vs-dialog"></p>
<h1 id="some-useful-links"><strong>Some useful links</strong></h1>
<ul>
<li><a href="https://github.com/dotnet/templating/wiki">https://github.com/dotnet/templating/wiki</a></li>
<li><a href="https://github.com/sayedihashimi/template-sample">https://github.com/sayedihashimi/template-sample</a></li>
<li><a href="https://github.com/Dotnet-Boxed/Templates">https://github.com/Dotnet-Boxed/Templates</a></li>
</ul>

    </div>
    
      
        <div class="pagination">
          <div class="pagination__title">
            <span class="pagination__title-h">Read other posts</span>
            <hr />
          </div>
          <div class="pagination__buttons">
            
              <span class="button previous">
                <a href="https://www.mytechramblings.com/posts/some-gotchas-when-deploying-a-dotnet-grpc-app-to-ecs/">
                  <span class="button__icon">←</span>
                  <span class="button__text">Some common gotchas when trying to deploy a dotnet gRPC app to AWS ECS</span>
                </a>
              </span>
            
            
              <span class="button next">
                <a href="https://www.mytechramblings.com/posts/create-dotnet-templates-for-visual-studio-part-1/">
                  <span class="button__text">How to build a .NET template and use it within Visual Studio. Part 1: Key concepts</span>
                  <span class="button__icon">→</span>
                </a>
              </span>
            
          </div>
        </div>
      
    


    
      
        

      
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2021 Powered by <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a></span>
        <span>Theme created by <a href="https://twitter.com/panr" target="_blank" rel="noopener">panr</a></span>
      </div>
    
  </div>
</footer>

<script src="https://www.mytechramblings.com/assets/main.js"></script>
<script src="https://www.mytechramblings.com/assets/prism.js"></script>
<script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="carlospons" data-description="Support me on Buy me a coffee!" data-message="If you find my blog useful, please consider buying me a cup of coffee. Thank you!" data-color="#FF5F5F" data-position="Right" data-x_margin="18" data-y_margin="18"></script>

      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-170300931-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    
  </body>
</html>
